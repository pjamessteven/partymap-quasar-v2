import{aj as O,aE as F,ao as U,al as R,as as z,am as f,ay as A,bB as W,_ as N,I as p,J as i,K as u,L as r,a4 as o,M as n,N as m,X as l,$ as c,U as b,V as P,z as I,a0 as x,Z as a,au as $,aN as j,aO as J,ae as S,Q as g,v as K,ag as C,a5 as Y,a6 as H,aH as X,a7 as Z,ax as E,an as ee,aD as se,af as te,Y as ne,at as re,a1 as L,a3 as V,T as B,ah as ie,ab as G}from"./index.458653eb.js";import{u as ae,E as oe,a as le,b as ue}from"./EventDateViewOptions.aefddd1d.js";import"./EventDateCard.08077f7e.js";import"./QBtnDropdown.36e88f67.js";const de={components:{MultipleMediaSelector:O},props:{username:{type:String,default:void 0}},data(){return{editing:!1,showAvatarDialog:!1,user:{avatar:null,username:null,alias:null,description:null}}},methods:{...F(U,["editUser","checkAuthCookie"]),share(){if(navigator.share)navigator.share({title:this.username+"'s Calendar'",text:"Check out "+this.user.username+"'s calendar on PartyMap",url:this.computedUrl});else if(navigator.clipboard)navigator.clipboard.writeText(this.computedUrl).then(()=>this.$q.notify("Copied profile link to clipboard")).catch(()=>this.$q.notify("Sharing not supported in this browser :("));else{try{var e=this.$refs.copyProfileUrlInput;e.select(),e.setSelectionRange(0,99999),document.execCommand("copy"),this.$q.notify("Copied profile link to clipboard")}catch{this.$q.notify("Sharing not supported in this browser :(")}return}},loadCurrentUserDetails(){this.user=this.currentUser,console.log(this.user),this.editing=!1},selectFile(e){var v;const t=(v=R(e))==null?void 0:v[0];t?this.user.avatar=t:this.user.avatar=null},selectAvatar(){this.$refs.mediaSelector.removeFile(0),this.$refs.mediaSelector.openSelectDialog()},async uploadAvatar(){const e=this.$q.dialog({title:"Uploading avatar...",color:"primary",progress:!0,cancel:!1,persistent:!0,ok:!1});try{await this.editUser({avatar:this.user.avatar})}catch{}await this.checkAuthCookie(),this.loadCurrentUserDetails(),e.hide(),this.showAvatarDialog=!1,this.editing=!1},async updateUser(){const e=this.$q.dialog({title:"Saving changes",color:"primary",progress:!0,cancel:!1,persistent:!0,ok:!1});try{await this.editUser(this.computedChanges)}catch{}e.hide(),this.editing=!1}},watch:{},computed:{...z(ae,["query"]),...f(A,["sidebarPanel"]),...f(U,["currentUser"]),computedChanges(){var e;return{description:this.user.description||void 0,alias:this.user.alias||void 0,username:this.user.username!==((e=this.currentUser)==null?void 0:e.username)?this.user.username:void 0}},computedUrl(){var e;return(e=this.user)!=null&&e.username?"https://partymap.com/user/"+this.user.username:""}},async mounted(){this.currentUser?this.loadCurrentUserDetails():this.username&&W(this.username).then(e=>{this.user=e.data})}},M=e=>(Y("data-v-9fb9a320"),e=e(),H(),e),ce={class:"profile-view flex column grow no-wrap"},me={class:"content flex column grow"},pe={class:"user-info flex row no-wrap"},he={class:"avatar flex items-center justify-center"},ge={key:0,class:"editing-overlay flex justify-center items-center"},ve=["src"],fe={class:"flex column grow justify-between"},we={class:"flex column"},ye={key:1},qe={key:0},_e={class:"action-buttons flex row q-mt-md"},be=M(()=>r("span",null,"Edit Profile",-1)),De={key:0},ke={key:1},xe=M(()=>r("span",null,"Done",-1)),Se=M(()=>r("span",null,"Cancel",-1)),Ce=M(()=>r("div",{class:"text-h6 inter bolder"},"Upload new avatar",-1)),Ue={key:0,class:"flex row q-gutter-sm q-mt-sm"},Me=["value"];function Pe(e,t,v,Q,s,h){var y,q,D,k;const _=p("MultipleMediaSelector");return i(),u("div",ce,[r("div",me,[r("div",pe,[r("div",{class:o(["avatar-wrapper",{editing:s.editing,"q-mr-lg":e.$q.screen.gt.xs}]),onClick:t[0]||(t[0]=()=>s.editing?s.showAvatarDialog=!0:void 0)},[r("div",he,[s.editing?(i(),u("div",ge,[n(m,{name:"mdi-account-arrow-up-outline",class:"text-white",size:"2em"})])):l("",!0),(q=(y=s.user)==null?void 0:y.avatar)!=null&&q.thumb_url?(i(),u("img",{key:1,src:s.user.avatar.thumb_url},null,8,ve)):s.editing?l("",!0):(i(),c(m,{key:2,name:"mdi-account-outline",class:"t4",size:"2em"}))])],2),r("div",fe,[r("div",we,[s.editing?l("",!0):(i(),u("div",{key:0,class:o(["inter bold t1",e.$q.screen.lt.sm?" ":"bolder text-large"])},[b(" @"+P(s.user.username),1),((D=s.user.hosted_events)==null?void 0:D.length)>0?(i(),c(m,{key:0,name:"mdi-check-decagram",class:"q-ml-sm"})):l("",!0),s.user.alias?(i(),u("span",ye," -\xA0"+P(s.user.alias),1)):l("",!0)],2)),s.editing?(i(),c(I,{key:1,modelValue:s.user.username,"onUpdate:modelValue":t[1]||(t[1]=d=>s.user.username=d),label:"Username",maxlength:"80"},null,8,["modelValue"])):l("",!0),s.editing?(i(),c(I,{key:2,modelValue:s.user.alias,"onUpdate:modelValue":t[2]||(t[2]=d=>s.user.alias=d),label:"Full Name (Optional)",maxlength:"200"},null,8,["modelValue"])):l("",!0),s.editing?(i(),c(I,{key:4,modelValue:s.user.description,"onUpdate:modelValue":t[3]||(t[3]=d=>s.user.description=d),label:"A little bit about yourself",maxlength:"1000",counter:""},null,8,["modelValue"])):(i(),u("div",{key:3,class:o(["inter t3 q-mt-sm",e.$q.screen.lt.sm?"":"  text-large"])},[s.user.description?(i(),u("span",qe,P(s.user.description),1)):l("",!0)],2))]),r("div",_e,[((k=e.currentUser)==null?void 0:k.username)===v.username&&!s.editing?(i(),u("div",{key:0,onClick:t[4]||(t[4]=x(()=>s.editing=!s.editing,["stop"])),class:"nav-button flex items-center justify-between q-mr-sm"},[be,n(m,{name:"mdi-square-edit-outline",size:(e.$q.screen.gt.xs,"1rem"),class:o({"q-ml-md":e.$q.screen.gt.xs,"q-ml-sm":e.$q.screen.lt.sm})},null,8,["size","class"])])):l("",!0),s.editing?l("",!0):(i(),u("div",{key:1,onClick:t[5]||(t[5]=x(d=>h.share(),["stop"])),class:"nav-button flex items-center justify-between q-mr-sm"},[e.$q.screen.lt.sm?(i(),u("span",De,"Share")):(i(),u("span",ke,"Share")),n(m,{name:"mdi-share",size:(e.$q.screen.gt.xs,"1rem"),class:o({"q-ml-md":e.$q.screen.gt.xs,"q-ml-sm":e.$q.screen.lt.sm})},null,8,["size","class"])])),s.editing?(i(),u("div",{key:2,onClick:t[6]||(t[6]=x(()=>h.updateUser(),["stop"])),class:"nav-button flex items-center justify-between q-mr-sm"},[xe,n(m,{name:"mdi-check",size:e.$q.screen.gt.xs?"1.5rem":"1rem",class:o({"q-ml-md":e.$q.screen.gt.xs,"q-ml-sm":e.$q.screen.lt.sm})},null,8,["size","class"])])):l("",!0),s.editing?(i(),u("div",{key:3,onClick:t[7]||(t[7]=x(()=>h.loadCurrentUserDetails(),["stop"])),class:"nav-button flex items-center justify-between q-mr-sm"},[Se,n(m,{name:"mdi-close",size:e.$q.screen.gt.xs?"1.5rem":"1rem",class:o({"q-ml-md":e.$q.screen.gt.xs,"q-ml-sm":e.$q.screen.lt.sm})},null,8,["size","class"])])):l("",!0)])])])]),n(K,{modelValue:s.showAvatarDialog,"onUpdate:modelValue":t[12]||(t[12]=d=>s.showAvatarDialog=d),"transition-show":"jump-up","transition-hide":"jump-down"},{default:a(()=>[n($,{class:"avatar-dialog dialog-card fullscreen-mobile-card"},{default:a(()=>[n(j,{class:"row items-center dialog-card-header"},{default:a(()=>[Ce,n(J),S(n(g,{icon:"close",flat:"",round:"",dense:"",onClick:t[8]||(t[8]=()=>s.user.avatar=null),class:"q-ml-xl"},null,512),[[C]])]),_:1}),n(j,{class:"t2 dialog-card-content flex column no-wrap items-start justify-start"},{default:a(()=>[b(" Your avatar will be visible to everyone on PartyMap. "),n(_,{ref:"mediaSelector",avatarMode:!0,class:"q-mt-md",singleSelectMode:!0,showUploadButton:!1,disableCaption:!0,onFilesSelected:t[9]||(t[9]=d=>h.selectFile(d)),label:"Select image"},null,512),s.user.avatar?(i(),u("div",Ue,[n(g,{color:"primary",label:"Save",onClick:t[10]||(t[10]=d=>h.uploadAvatar())}),n(g,{flat:"",label:"Select new",onClick:t[11]||(t[11]=d=>h.selectAvatar())})])):l("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]),r("input",{value:h.computedUrl,ref:"copyProfileUrlInput",style:{display:"none"}},null,8,Me)])}var Ie=N(de,[["render",Pe],["__scopeId","data-v-9fb9a320"]]);const Ee={components:{EventDateList:oe,EventDatePosterList:le,EventDateViewOptions:ue,MenuWrapper:X,InnerLoading:Z,UserProfile:Ie},props:{showControls:{default:!1},username:{default:null},scrollPercentage:{default:0}},mounted(){this.getInitialList()},data(){return{showingYouMenu:!1,tense:"future",mode:"all",mainContentScrollPosition:0,scrollingUp:!1,headerYPosition:0,year:0,componentGroup:{},isLoadingDatesInitial:!1}},methods:{...F(E,["loadUserEventDates"]),async getInitialList(){this.userEventDates=[],this.isLoadingDatesInitial=!0,this.$refs&&this.$refs.scroll.setScrollPercentage("vertical",0),this.userEventDatesHasNext=!0,this.userEventDatesPage=1,this.loadMore()},async loadMore(){if(this.userEventDatesHasNext)try{await this.loadUserEventDates(this.mode,this.tense,this.username||this.currentUser.username),this.userEventDatesPage+=1,this.isLoadingDatesInitial=!1}catch{this.isLoadingDatesInitial=!1}}},watch:{mode(){this.getInitialList()},tense(){this.getInitialList()},currentUser(){this.sidebarPanel==="favorites"&&this.getInitialList()},computedScrollPercentage(e){e===1&&this.loadMore()}},computed:{computedScrollPercentage(){return this.scrollPercentage},...f(A,["sidebarPanel","userLocation","compactView","groupEventsByMonth"]),...z(A,["showPanel","enablePanelSwipeDown"]),...f(U,["currentUser"]),...f(ee,["mapBounds","blockUpdates"]),...f(E,["userEventDatesLoading"]),...z(E,["userEventDatesGroupedByMonth","userEventDates","userEventDatesPage","userEventDatesHasNext"])},created(){this.debouncedGetInitalList=se.debounce(this.getInitialList,150,{leading:!1,trailing:!0})}},w=e=>(Y("data-v-ae548daa"),e=e(),H(),e),Le={class:"favorites-view shadow-0 main-content",style:{height:"100%",width:"100%",position:"relative"}},Ve={class:"flex column no-wrap content"},Be=w(()=>r("div",{class:"flex items-center row no-wrap"},[r("div",null,"All")],-1)),ze={class:"flex items-center row no-wrap"},Ae=w(()=>r("div",null,"Going",-1)),Ne={class:"flex items-center row no-wrap"},Qe=w(()=>r("div",null,"Interested",-1)),je={class:"flex items-center row no-wrap"},Ge=w(()=>r("div",null,"More",-1)),Fe=w(()=>r("div",{class:"separator vertical q-ml-md q-mr-sm",style:{height:"32px"}},null,-1)),Ye={class:"flex items-center row no-wrap"},He=w(()=>r("div",null,"Upcoming",-1)),Te={class:"flex items-center row no-wrap"},Oe=w(()=>r("div",null,"Past",-1)),Re={class:"event-date-center flex grow justify-center",style:{height:"100%",position:"absolute",width:"100%",top:"0px"}};function We(e,t,v,Q,s,h){const _=p("UserProfile"),y=p("MenuWrapper"),q=p("CustomQScroll"),D=p("EventDateViewOptions"),k=p("EventDateList"),d=p("EventDatePosterList"),T=p("InnerLoading");return i(),u("div",Le,[n(B,{"enter-active-class":"animated fadeIn"},{default:a(()=>[r("div",{class:o(["flex column no-wrap scroll-content",e.$q.screen.lt.sm?"q-px-sm ":""])},[n(_,{username:v.username,class:o({"q-mt-lg q-mb-lg q-px-md":e.$q.screen.gt.xs,"q-mx-sm  q-my-md q-mb-md":e.$q.screen.lt.sm})},null,8,["username","class"]),n(te),r("div",Ve,[r("div",{class:o(["q-mt-md flex row no-wrap items-center control-bar",e.$q.screen.gt.xs?"q-pl-md q-mb-md":""])},[n(q,{ref:"scroll",horizontal:"",class:"scroll-area grow",style:ne(e.$q.screen.gt.xs?"height: 54px":"height: 44px"),"thumb-style":e.$q.screen.gt.xs?{bottom:"2px",height:"4px"}:{bottom:"-8px",height:"0px"}},{default:a(()=>[r("div",{class:o(["flex row items-center scroll-wrapper",[e.$q.screen.gt.xs?e.$q.screen.lt.xl?"q-gutter-sm q-pr-md q-py-xs no-wrap":"q-gutter-sm q-pr-md q-py-xs  no-wrap":"q-gutter-sm q-px-sm  no-wrap"]])},[n(g,{"no-caps":"",class:o(["button-plain flex items-center",{active:s.mode==="all"}]),onClick:t[0]||(t[0]=()=>{s.mode="all"})},{default:a(()=>[Be]),_:1},8,["class"]),n(g,{"no-caps":"",class:o(["button-plain flex items-center",{active:s.mode==="going"}]),onClick:t[1]||(t[1]=()=>{s.mode="going"})},{default:a(()=>[r("div",ze,[n(m,{name:"mdi-check-circle",class:"q-pr-md",size:"1rem"}),Ae])]),_:1},8,["class"]),n(g,{"no-caps":"",class:o(["button-plain flex items-center",{active:s.mode==="interested"}]),onClick:t[2]||(t[2]=()=>{s.mode="interested"})},{default:a(()=>[r("div",Ne,[n(m,{name:"mdi-star-outline",class:"q-pr-md",size:"1rem"}),Qe])]),_:1},8,["class"]),n(g,{"no-caps":"",class:o(["button-plain flex items-center",{active:s.mode==="hosting"||s.mode==="created"||s.mode==="following"}]),onClick:t[8]||(t[8]=()=>{s.showingYouMenu=!s.showingYouMenu})},{default:a(()=>[r("div",je,[n(m,{name:"mdi-dots-vertical",class:"q-pr-md",size:"1rem"}),Ge]),n(y,{showing:s.showingYouMenu,onHide:t[6]||(t[6]=()=>s.showingYouMenu=!1),onShow:t[7]||(t[7]=()=>s.showingYouMenu=!0),class:"menu-wrapper inter bold"},{default:a(()=>[n(re,{class:o(e.$q.screen.lt.sm?"q-pb-xl":void 0)},{default:a(()=>[S((i(),c(V,{active:s.mode==="hosting",clickable:"",onClick:t[3]||(t[3]=()=>{s.mode="hosting"})},{default:a(()=>[n(L,null,{default:a(()=>[b(" Hosting")]),_:1})]),_:1},8,["active"])),[[C]]),S((i(),c(V,{active:s.mode==="created",clickable:"",onClick:t[4]||(t[4]=()=>{s.mode="created"})},{default:a(()=>[n(L,null,{default:a(()=>[b(" Created")]),_:1})]),_:1},8,["active"])),[[C]]),S((i(),c(V,{active:s.mode==="following",clickable:"",onClick:t[5]||(t[5]=()=>{s.mode="following"})},{default:a(()=>[n(L,null,{default:a(()=>[b(" Contributed/Reviewed ")]),_:1})]),_:1},8,["active"])),[[C]])]),_:1},8,["class"])]),_:1},8,["showing"])]),_:1},8,["class"]),Fe,n(g,{"no-caps":"",class:o(["button-plain flex items-center",{active:s.tense==="future"}]),onClick:t[9]||(t[9]=()=>{s.tense="future"})},{default:a(()=>[r("div",Ye,[n(m,{name:"mdi-clock-time-nine-outline",class:"q-pr-md",size:"1rem"}),He])]),_:1},8,["class"]),n(g,{"no-caps":"",class:o(["button-plain flex items-center",{active:s.tense==="past"}]),onClick:t[10]||(t[10]=()=>{s.tense="past"})},{default:a(()=>[r("div",Te,[n(m,{name:"mdi-history",class:"q-pr-md",size:"1rem"}),Oe])]),_:1},8,["class"])],2)]),_:1},8,["style","thumb-style"]),e.$q.screen.gt.xs?(i(),c(D,{key:0,showGroupByMonth:!1,class:"q-mb-sm"})):l("",!0)],2),n(B,{appear:"","enter-active-class":"animated fadeIn slower"},{default:a(()=>[e.userEventDates&&e.compactView&&!s.isLoadingDatesInitial?(i(),c(k,{key:0,groupByMonth:e.$q.screen.lt.md,eventDatesGroupedByMonth:e.userEventDatesGroupedByMonth,eventDates:e.userEventDates,hasNext:e.userEventDatesHasNext,twoColumnsMd:!0},null,8,["groupByMonth","eventDatesGroupedByMonth","eventDates","hasNext"])):l("",!0)]),_:1}),n(B,{appear:"","enter-active-class":"animated fadeIn slower"},{default:a(()=>[e.userEventDates&&!e.compactView&&!s.isLoadingDatesInitial?(i(),c(d,{key:0,groupByMonth:!1,eventDatesGroupedByMonth:e.userEventDatesGroupedByMonth,eventDates:e.userEventDates,hasNext:e.userEventDatesHasNext},null,8,["eventDatesGroupedByMonth","eventDates","hasNext"])):l("",!0)]),_:1})])],2)]),_:1}),r("div",Re,[s.isLoadingDatesInitial?(i(),c(T,{key:0,solid:!1,fixed:!0})):l("",!0)])])}var $e=N(Ee,[["render",We],["__scopeId","data-v-ae548daa"]]);const Je={components:{SolidPage:ie,FavoritesView:$e},props:{username:{default:null}},data(){return{scrollPercentage:0,user:null,loading:!1}},mounted(){},methods:{},watch:{},computed:{...f(U,["currentUser"])},created(){this.timeAgo=G.timeAgo,this.dateUTCToLocal=G.dateUTCToLocal}};function Ke(e,t,v,Q,s,h){const _=p("FavoritesView"),y=p("SolidPage");return i(),c(y,{onScrollPercentage:t[0]||(t[0]=q=>s.scrollPercentage=q)},{default:a(()=>[n(_,{scrollPercentage:s.scrollPercentage,username:v.username},null,8,["scrollPercentage","username"])]),_:1})}var ts=N(Je,[["render",Ke],["__scopeId","data-v-65017199"]]);export{ts as default};
